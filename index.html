// ...existing code...
<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calendario settimanale</title>
  <style>
    :root{--bg:#0d6efd;--card:#fff;--muted:#6c757d;--accent:#0747d1}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:#111}
    .wrap{max-width:1200px;margin:28px auto;padding:20px}
    header{color:#fff;text-align:center;margin-bottom:18px}
    h1{margin:0;font-size:1.6rem}
    .week{display:grid;grid-template-columns:repeat(7,1fr);gap:14px}
    @media (max-width:900px){.week{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:480px){.week{grid-template-columns:1fr}}
    .day{background:var(--card);border-radius:10px;padding:12px;box-shadow:0 6px 18px rgba(0,0,0,0.12);display:flex;flex-direction:column;min-height:160px}
    .day-link{display:flex;flex-direction:column;color:inherit;text-decoration:none;height:100%}
    .day-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
    .day-name{font-weight:600;color:var(--accent)}
    .day-number{background:var(--bg);color:#fff;width:36px;height:36px;display:flex;align-items:center;justify-content:center;border-radius:6px;font-weight:700}
    .muted{font-size:0.85rem;color:var(--muted)}
    .notes{margin-top:6px;flex:1;display:flex;flex-direction:column;justify-content:flex-start}
    .preview{white-space:pre-wrap;color:#222;overflow:hidden;max-height:120px}
    .today{outline:3px solid rgba(255,255,255,0.12)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Calendario settimanale</h1>
      <div class="muted" id="week-range"></div>
    </header>

    <main class="week" id="week" aria-label="Settimana">
      <!-- giorni generati da script -->
    </main>
  </div>

  <script>
    const weekEl = document.getElementById('week');
    const rangeEl = document.getElementById('week-range');
    const dayNames = ['Lunedì','Martedì','Mercoledì','Giovedì','Venerdì','Sabato','Domenica'];

    function startOfWeek(date){
      const d = new Date(date.getFullYear(), date.getMonth(), date.getDate());
      const day = (d.getDay() + 6) % 7; // 0 = Monday
      d.setDate(d.getDate() - day);
      return d;
    }

    function ymd(d){
      return d.toISOString().slice(0,10);
    }

    function short(d){
      return d.getDate() + '/' + (d.getMonth()+1);
    }

    function escapeHtml(s){
      return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
    }

    function renderWeek(today = new Date()){
      weekEl.innerHTML = '';
      const monday = startOfWeek(today);
      const sunday = new Date(monday); sunday.setDate(monday.getDate()+6);
      rangeEl.textContent = short(monday) + ' — ' + short(sunday);

      for(let i=0;i<7;i++){
        const dt = new Date(monday); dt.setDate(monday.getDate()+i);
        const key = 'note-'+ymd(dt);
        const saved = localStorage.getItem(key) || '';
        const isToday = ymd(dt) === ymd(new Date());

        const card = document.createElement('section');
        card.className = 'day';

        const href = `note.html?date=${encodeURIComponent(ymd(dt))}`;
        const preview = saved ? escapeHtml(saved).replace(/\n/g,' ') .slice(0,200) : '';

        card.innerHTML = `
          <a class="day-link" href="${href}" aria-label="Apri note per ${dt.toLocaleDateString()}">
            <div class="day-header">
              <div>
                <div class="day-name">${dayNames[i]}</div>
                <div class="muted">${dt.toLocaleDateString()}</div>
              </div>
              <div class="day-number" title="${dt.toLocaleDateString()}">${dt.getDate()}</div>
            </div>
            <div class="notes">
              <div class="preview">${preview || '<span class="muted">Nessuna nota</span>'}</div>
            </div>
          </a>
        `;
        if(isToday) card.classList.add('today');
        weekEl.appendChild(card);
      }
    }

    renderWeek();
  </script>
</body>
</html>
// ...existing code...